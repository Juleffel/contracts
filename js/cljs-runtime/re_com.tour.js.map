{"version":3,"sources":["re_com/tour.cljs"],"mappings":"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","names":["re-com.tour/make-tour","tour-spec","tour-map","cljs.core.atom.cljs$core$IFn$_invoke$arity$1","p1__45873#","p2__45874#","cljs.core.reduce.cljs$core$IFn$_invoke$arity$3","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","reagent.core.atom.cljs$core$IFn$_invoke$arity$1","re-com.tour/initialise-tour","tour","cljs.core.doall.cljs$core$IFn$_invoke$arity$1","iter__4582__auto__","s__45892","cljs.core/LazySeq","temp__5735__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4580__auto__","size__4581__auto__","cljs.core/count","b__45894","cljs.core/chunk-buffer","i__45893","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__45891","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","step","cljs.core/reset!","re-com.tour/start-tour","fexpr__45914","re-com.tour/finish-tour","re-com.tour/next-tour-step","cljs.core/deref","steps","old-step","new-step","fexpr__45921","cljs.core.nth.cljs$core$IFn$_invoke$arity$2","fexpr__45923","re-com.tour/prev-tour-step","fexpr__45932","fexpr__45933","re-com.tour/make-tour-nav","on-first-button","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","on-last-button","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","re-com.box/flex-child-style","re-com.buttons/button","event","cljs.core/chunk-first"],"sourcesContent":["(ns re-com.tour\r\n  (:require-macros [re-com.core :refer [handler-fn]])\r\n  (:require [reagent.core   :as    reagent]\r\n            [re-com.box     :refer [flex-child-style]]\r\n            [re-com.buttons :refer [button]]))\r\n\r\n\r\n;;--------------------------------------------------------------------------------------------------\r\n;; Component: tour\r\n;;\r\n;;   Strings together\r\n;;--------------------------------------------------------------------------------------------------\r\n\r\n(defn make-tour\r\n  \"Returns a map containing\r\n  - A reagent atom for each tour step controlling popover show/hide (boolean)\r\n  - A standard atom holding the current step (integer)\r\n  - A copy of the steps parameter passed in, to determine the order for prev/next functions\r\n  It sets the first step atom to true so that it will be initially shown\r\n  Sample return value:\r\n  {:steps [:step1 :step2 :step3]\r\n  :current-step (atom 0)\r\n  :step1 (reagent/atom true)\r\n  :step2 (reagent/atom false)\r\n  :step3 (reagent/atom false)}\"\r\n  [tour-spec]\r\n  (let [tour-map {:current-step (atom 0) :steps tour-spec}] ;; Only need normal atom\r\n\r\n    (reduce #(assoc %1 %2 (reagent/atom false)) tour-map tour-spec))) ;; Old way: (merge {} (map #(hash-map % (reagent/atom false)) tour-spec))\r\n\r\n\r\n(defn- initialise-tour\r\n  \"Resets all poover atoms to false\"\r\n  [tour]\r\n  (doall (for [step (:steps tour)] (reset! (step tour) false))))\r\n\r\n\r\n(defn start-tour\r\n  \"Sets the first popover atom in the tour to true\"\r\n  [tour]\r\n  (initialise-tour tour)\r\n  (reset! (:current-step tour) 0)\r\n  (reset! ((first (:steps tour)) tour) true))\r\n\r\n\r\n(defn finish-tour\r\n  \"Closes all tour popovers\"\r\n  [tour]\r\n  (initialise-tour tour))\r\n\r\n\r\n(defn- next-tour-step\r\n  [tour]\r\n  (let [steps     (:steps tour)\r\n        old-step  @(:current-step tour)\r\n        new-step  (inc old-step)]\r\n    (when (< new-step (count (:steps tour)))\r\n      (reset! (:current-step tour) new-step)\r\n      (reset! ((nth steps old-step) tour) false)\r\n      (reset! ((nth steps new-step) tour) true))))\r\n\r\n\r\n(defn- prev-tour-step\r\n  [tour]\r\n  (let [steps    (:steps tour)\r\n        old-step @(:current-step tour)\r\n        new-step (dec old-step)]\r\n    (when (>= new-step 0)\r\n      (reset! (:current-step tour) new-step)\r\n      (reset! ((nth steps old-step) tour) false)\r\n      (reset! ((nth steps new-step) tour) true))))\r\n\r\n\r\n(defn make-tour-nav\r\n  \"Generate the hr and previous/next buttons markup.\r\n  If first button in tour, don't generate a Previous button.\r\n  If last button in tour, change Next button to a Finish button\"\r\n  [tour]\r\n  (let [on-first-button (= @(:current-step tour) 0)\r\n        on-last-button  (= @(:current-step tour) (dec (count (:steps tour))))]\r\n    [:div\r\n     [:hr {:style (merge (flex-child-style \"none\")\r\n                         {:margin \"10px 0px 10px\"})}]\r\n      (when-not on-first-button\r\n        [button\r\n         :label    \"Previous\"\r\n         :on-click (handler-fn (prev-tour-step tour))\r\n         :style    {:margin-right \"15px\"}\r\n         :class     \"btn-default\"])\r\n      [button\r\n       :label    (if on-last-button \"Finish\" \"Next\")\r\n       :on-click (handler-fn (if on-last-button\r\n                               (finish-tour tour)\r\n                               (next-tour-step tour)))\r\n       :class     \"btn-default\"]]))\r\n"]}